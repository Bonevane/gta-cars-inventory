<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>GTA Used Car Inventory</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <nav>
      <a href="/">Home</a>
      <a href="/manufacturers">Manufacturers</a>
      <a href="/classes">Classes</a>
      <a href="/cars">All Cars</a>
    </nav>
    <main></main>
  </body>

  <script>
    function openModal(id) {
      document.getElementById(`carModal-${id}`).classList.remove("hidden");
    }

    function closeModal(id) {
      document.getElementById(`carModal-${id}`).classList.add("hidden");
    }

    function openManufacturersModal() {
      document.getElementById("manufacturersModal").classList.remove("hidden");
    }

    function closeManufacturersModal() {
      document.getElementById("manufacturersModal").classList.add("hidden");
    }

    function openEditForm(id) {
      document.getElementById(`editForm-${id}`).classList.toggle("hidden");
    }

    function showCarPopup(id) {
      fetch(`/cars/${id}`)
        .then((res) => res.json())
        .then((car) => {
          document.getElementById("popupContent").innerHTML = `
        <div class="car-popup-top">
            <img src="${car.image_url}" style="width: 100%" />
            <div class="car-info-simple">
                <div class="car-info-simple-top">
                <div class="origin">
                    <img src="https://flagcdn.com/24x18/${car.country}.png" />
                    <p style="font-weight:600; text-transform: uppercase;">${car.man_name}</p>
                </div>
                <h2>${car.model}</h2>
                <p style="margin-bottom: 1rem;"><text class="car-class">${car.class_name}</text></p>
                <div>
                    <div style="text-align: justify;">
                        <text class="small-text">Lap Time:</text>
                        <text class="medium-text">${car.lap_time}</text>
                    </div>
                    <div>
                        <text class="small-text">Top Speed:</text>
                        <text class="medium-text">${car.top_speed}</text>
                    </div>
                </div>
                </div>
                <div class="car-info-simple-bottom">
                    <text class="small-text">PRICE:</text>
                    <text class="medium-text">$</text>
                    <text class="huge-text">${car.price}</text>
                </div>
            </div>
            </div>
            <div class="car-popup-mid">
            <div class="car-info">
                <div>
                <p>Weight:</p>
                <p>${car.weight} kg</p>
                </div>
                <div>
                <p>Engine Power:</p>
                <p>${car.engine_power}</p>
                </div>
                <div>
                <p>Seats:</p>
                <p>${car.doors}</p>
                </div>
                <div>
                <p>Drivetrain:</p>
                <p>${car.drive_type}</p>
                </div>
                <div>
                <p>Drag:</p>
                <p>${car.drag_coefficient}</p>
                </div>
                <div>
                <p>brake_force:</p>
                <p>${car.brake_force}</p>
                </div>
            </div>
            </div>
        <div class="car-popup-bottom">
        <button class="light" onclick="closeCarPopup()">Close</button>
        <button onclick="openEditCarModal(${car.id})">Edit Car</button>
        <form
            action="/cars/${car.id}?_method=DELETE"
            method="POST"
            onsubmit="return confirm('Are you sure you want to delete this car?')"
        >
            <button type="submit" class="delete">Remove from List</button>
        </form>
        </div>
      `;
          document.getElementById("carPopup").style.display = "flex";
        });
    }

    function closeCarPopup() {
      document.getElementById("carPopup").style.display = "none";
    }

    // Optional: preload edit modal function here if you want inline editing
    function openEditCarModal(id) {
      fetch(`/cars/${id}/edit`)
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("popupContent").innerHTML = html;
        });
    }

    function openCarModal() {
      document.getElementById("carModal").classList.remove("hidden");
    }
    function closeCarModal() {
      document.getElementById("carModal").classList.add("hidden");
    }

    function openEditManufacturerModal() {
      document.getElementById("editManufacturerModal").style.display = "block";
    }

    function closeEditManufacturerModal() {
      document.getElementById("editManufacturerModal").style.display = "none";
    }

    function openEditClassModal() {
      document.getElementById("editClassModal").style.display = "block";
    }

    function closeEditClassModal() {
      document.getElementById("editClassModal").style.display = "none";
    }
  </script>
</html>
